# CFSpider 技能系统

## 概述

技能系统让 AI 像真人一样学习和掌握操作流程。通过重复成功的操作，AI 会自动将经验升级为可复用的技能。

## 技能类型

### 内置技能
预定义的常见操作流程，开箱即用：
- `bing-search.md` - 必应搜索
- `click-search-result.md` - 点击搜索结果
- `navigate-to-website.md` - 访问网站
- `iqiyi-navigation.md` - 爱奇艺导航

### 学习技能
AI 从实际操作中学习并自动生成的技能：
- 当某个操作成功 3 次以上且记忆强度 >= 70
- 自动提升为技能，保存到 `skills.json`
- 技能会包含触发词、操作步骤、成功率

## 学习流程（像真人一样学习）

### 从零开始学会一个操作

```
第1次操作（成功）
  ↓
创建学习记忆
  - 强度: 40
  - 类型: success
  - 记录: 操作方法、选择器
  - 30%概率保存到磁盘

第2次成功
  ↓
强化记忆
  - 强度: 55 (+15)
  - 回忆次数: 2
  - 可能保存到磁盘

第3次成功
  ↓
强化记忆 + 达到提升条件
  - 强度: 70 (+15)
  - 回忆次数: 3
  ↓
自动提升为技能！
  ↓
技能生成
  - 名称: "domain-action-target"
  - 触发词: 从记忆中提取
  - 步骤: 从成功操作中总结
  - 初始成功率: 60 + (回忆次数 × 5)
  - 永久保存到 skills.json

第4次及以后
  ↓
使用技能执行（更快更准）
  - 技能成功率持续提升
  - 学习新的模式和选择器
  - 优化备选方案
```

### 记忆永不丢失

- 记忆强度会衰减，但**永远不会被删除**
- 强度 > 60: 清晰记忆，随时能用
- 强度 30-60: 偶尔想不起来
- 强度 10-30: 很难想起来
- 强度 5-10: 需要提示才能想起
- 强度 < 5: 几乎忘了，但有 5% 概率**突然想起来**

### 突然回忆机制

```
[记忆强度 3, 快忘了]
  ↓
相关操作触发
  ↓
5% 概率突然想起来！
  ↓
"诶？我突然想起来了！"
  ↓
强度恢复 +30
  - 新强度: 33
  - 重新变成可用记忆
```

## 技能进化

### 初期（0-5次使用）
- 使用预定义的步骤
- 成功率基于初始值

### 成长期（5-20次使用）
- 从每次操作中提取模式
- 学习最佳选择器和流程
- 自动优化步骤的备选方案

### 成熟期（20次以上）
- 成功率稳定
- 拥有多个学习到的模式
- 选择器优先使用成功率最高的

## 技能文件格式

每个技能用 Markdown 描述，便于阅读和编辑：

```markdown
# 技能名称

## 基本信息
- ID: skill-id
- 触发词: 关键词列表
- 适用域名: 域名列表

## 操作步骤
1. 动作类型
2. 目标选择器
3. 备选方案

## 学习模式
记录已知的成功模式和常见问题
```

## 持久化（永久保存）

- 学习记忆: `%APPDATA%/cfspider-browser/learning-memory.json`
- 技能数据: `%APPDATA%/cfspider-browser/skills.json`
- 自动保存: 30% 概率渐进保存
- **容量限制**: 无限制（永久保存，像真人一辈子都会）
- **遗忘机制**: 记忆强度会衰减，但永远不会真正删除
  - 强度高：清晰记忆，随时能想起来
  - 强度低：很难想起来，但记忆永远在
  - 突然回忆：即使快忘了，也有 5% 概率突然想起来

## 示例

### 学习过程
```
用户: "打开 GitHub"
1. 搜索 GitHub -> 成功 ✓ [创建记忆]
2. 点击第1个结果 -> 成功 ✓ [强化记忆]
3. 再次"打开 GitHub" -> 成功 ✓ [提升为技能]

自动生成技能:
- 名称: "bing.com-click-GitHub"
- 触发词: ["github", "click"]
- 步骤: scan -> click_by_index(type="link", index=1)
- 成功率: 75%
```

### 技能使用
```
用户: "打开 GitHub"
-> 匹配到技能 "bing.com-click-GitHub"
-> AI 看到技能提示，按照已知流程执行
-> 操作更快更准确
```

## 技能优化

技能会自动从失败中学习：
- 记录失败的选择器，下次跳过
- 将成功的新选择器添加为备选
- 调整步骤顺序以提高成功率

## 未来扩展

计划添加的技能：
- 京东/淘宝购物流程
- 社交媒体发帖
- 表单自动填写
- 视频网站操作
- 登录认证流程
